# macOS ユーザのための X680x0 エミュレータ XEiJ 導入ガイド (工事中)

2023.1 tantan

---

### はじめに

令和の今、X680x0 が再びの盛り上がりを見せています。ひとえに [瑞起(Zuiki,Inc.)によるX68000Zの発表](https://www.zuiki.co.jp/products/x68000z/) によるものが大きいと思いますが、様々な条件がうまく噛み合って、タイミングが良かったのだと思います。

そんな X68000Z は　"X68000初代 10MHz FDモデル 12MBメモリフル実装" をエミュレーションにて実現するというデザインになっているとのことです。
残念ながら HDDイメージには今のところ対応していないので、箱庭のような自分だけの X680x0 環境を育てていこうと思えば、別な形を探る必要があります。

具体的には、有志が開発・メンテナンスを継続してくださっているX680x0エミュレータの利用です。
種類は複数あるのですが、こと macOS を前提にすると、選択肢はほぼ一択で鎌田さんによる XEiJ です。

* [XEiJ](https://stdkmd.net/xeij/)

XEiJの大きな特徴は、Javaで開発されているということです。すなわちmacOSを含めJavaが動く環境であればどこでも動作可能となります。
自分は ARMアーキテクチャの Apple silicon (M1) を搭載した MacBook Air で動かしていますが、動作も非常に軽快ですし、使っていて違和感がありません。

そして何よりX680x0のハードウェアの非常に細かいところまで詳細に分析・実装されています。

作者の鎌田さんは自分が現役でX68000XVIの実機を使っていた頃からお名前を随所でお見かけしていたレジェンドの一人でもあり、060turboを含めた多くの拡張ハードウェア用のドライバやアプリケーションなどを開発されておられました。まさにX680x0を知り尽くした一人によるエミュレータと言えます。

このドキュメントは macOS にこの XEiJ を導入する際のいくつかのポイントを覚書として残しておくものです。

なお、これ以外に macOS で動作するものとして、X680x0のコマンドラインアプリケーションをエミュレーション実行できる run68 というのがあります。
これはこれで非常に強力なもので、導入必須とも言えるのですが、このドキュメントでは割愛します。

---

### OpenJDK のダウンロード

macOSにはもう標準でJavaが付属することはなくなったので、自分で導入する必要があります。
Javaの本家は Sun Microsystems → 買収されて Oracle となっていますが、Oracleの提供するOracle JDKは一度有料化されました。
その後再び無償化したのですが、今後も不透明なので、ここはオープン版のOpenJDKを導入するのが確実です。

macOS用のOpenJDKは以下からダウンロードできます。2022.10月版のXEiJを動かすにはOpenJDKバージョン19が必要です。

* [openjdk.org](https://jdk.java.net/19/)
* [adoptium.net](https://adoptium.net/)

2つあるサイトのうち、上は本家なのですが、バイナリ配布形態が素の `*.tar.gz` のみとなっています。
下のadoptiumの方は `*.pkg` でインストーラで導入できますので、個人的にはこちらをお勧めします。
Eclipse Foundationによる管理下にあるサイトで信頼できます。

Apple silicon の Mac を使っている場合は aarch64 もしくは arm64 となっているパッケージを、intel CPU の Mac を使っている場合は x64 もしくは x86_64 のパッケージを導入します。

既に他のJDKを導入済みであっても、複数バージョンを同居させることが可能です。
adoptiumのパッケージから導入した場合は以下にインストールされます。

    /Library/Java/JavaVirtualMachines/temurin-19.jdk/

導入後、新しいターミナルを開いて `java -version` でバージョンを確認します。

    $ java -version
    openjdk version "19.0.1" 2022-10-18
    OpenJDK Runtime Environment Temurin-19.0.1+10 (build 19.0.1+10)
    OpenJDK 64-Bit Server VM Temurin-19.0.1+10 (build 19.0.1+10, mixed mode)
    
バージョン19が表示されればokです。

---

### XEiJ の導入
